{
  "_comment": "XOAUTH2 Proxy v2.0 - Global Configuration",
  "_version": "2.0",
  "_description": "Global settings and provider defaults. Account credentials are in accounts.json (separate file).",

  "global": {
    "_description": "Global proxy settings that apply to all accounts",

    "backpressure_queue_size": 10000,
    "_backpressure_queue_size_doc": "Maximum queued messages before rejecting new connections (OPTIMIZED: 10000 for burst handling with 500+ accounts)",

    "oauth2_timeout": 10,
    "_oauth2_timeout_doc": "Timeout for OAuth2 token refresh requests to Google/Microsoft (default: 10 seconds)",

    "http_pool": {
      "_description": "HTTP connection pool for OAuth2 API requests",

      "total_connections": 5000,
      "_total_connections_doc": "Maximum total HTTP connections across all hosts (default: 5000)",

      "connections_per_host": 100,
      "_connections_per_host_doc": "Maximum connections per host (Google/Microsoft OAuth2 endpoints) (default: 100)",

      "dns_cache_ttl_seconds": 300,
      "_dns_cache_ttl_seconds_doc": "DNS cache TTL in seconds (default: 300 = 5 minutes)",

      "connect_timeout_seconds": 5,
      "_connect_timeout_seconds_doc": "Timeout for establishing HTTP connection (default: 5 seconds)"
    },

    "smtp": {
      "_description": "SMTP protocol settings",

      "use_source_ip_binding": true,
      "_use_source_ip_binding_doc": "Enable source IP binding for outbound SMTP connections (default: true, allows using multiple server IPs)",

      "validate_source_ip": true,
      "_validate_source_ip_doc": "Validate that IP addresses exist on server before using (default: true, prevents config errors)",

      "use_ipv6": false,
      "_use_ipv6_doc": "Use IPv6 addresses for sending (default: false, most providers work better with IPv4)"
    }
  },

  "providers": {
    "_description": "Provider-specific defaults for Gmail, Outlook, and fallback",

    "gmail": {
      "_description": "Gmail (smtp.gmail.com:587) default settings",

      "max_concurrent_messages": 200,
      "_max_concurrent_messages_doc": "Maximum concurrent messages per account (TUNED: 200, Gmail has more generous rate limits)",

      "connection_pool": {
        "max_connections_per_account": 50,
        "max_messages_per_connection": 200,
        "connection_max_age_seconds": 300,
        "connection_idle_timeout_seconds": 30
      },

      "retry": {
        "max_attempts": 2,
        "backoff_factor": 2.0,
        "max_delay_seconds": 30,
        "jitter_enabled": true
      },

      "circuit_breaker": {
        "enabled": true,
        "failure_threshold": 5,
        "recovery_timeout_seconds": 60
      }
    },

    "outlook": {
      "_description": "Outlook (smtp.office365.com:587) default settings - OPTIMIZED for high-volume",

      "max_concurrent_messages": 150,
      "_max_concurrent_messages_doc": "OPTIMIZED: 150 concurrent messages per account",

      "connection_pool": {
        "max_connections_per_account": 50,
        "max_messages_per_connection": 150,
        "connection_max_age_seconds": 240,
        "connection_idle_timeout_seconds": 30
      },

      "retry": {
        "max_attempts": 2,
        "backoff_factor": 2.0,
        "max_delay_seconds": 30,
        "jitter_enabled": true
      },

      "circuit_breaker": {
        "enabled": true,
        "failure_threshold": 5,
        "recovery_timeout_seconds": 60
      }
    },

    "default": {
      "_description": "Default settings for unknown/custom providers - CONSERVATIVE fallback",

      "max_concurrent_messages": 100,

      "connection_pool": {
        "max_connections_per_account": 30,
        "max_messages_per_connection": 100,
        "connection_max_age_seconds": 300,
        "connection_idle_timeout_seconds": 60
      },

      "retry": {
        "max_attempts": 2,
        "backoff_factor": 2.0,
        "max_delay_seconds": 30,
        "jitter_enabled": true
      },

      "circuit_breaker": {
        "enabled": true,
        "failure_threshold": 5,
        "recovery_timeout_seconds": 60
      }
    }
  }
}
